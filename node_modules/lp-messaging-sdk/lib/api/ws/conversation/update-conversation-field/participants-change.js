const {updateConversationField, UpdateConversationFieldName, v2Context, v3Context} = require('./update-conversation-field');

/*
conversationField: {
    field: "ParticipantsChange",
    userId: agentId,
    role: "AGENT", // MANAGER, CONTROLLER
    type: "ADD"
}


- Join as controller
{
    field: 'ParticipantsChange',
    type: 'ADD',
    role: 'CONTROLLER',
    dialogId: dialogId ? dialogId : convId
}

*/
/**
 * @private
 * @param conversationId {string}
 * @param agentId {string}
 * @param participantRole {ParticipantRole}
 * @param participantChangeType {ParticipantChangeType}
 * @returns {object}}
 */
function participantsChange(conversationId, agentId, participantRole, participantChangeType) {
    const data = participantsChangeData(agentId, participantRole, participantChangeType)
    return updateConversationField.call(this, conversationId, [data]);
}

function participantsChangeData(agentId, participantRole, participantChangeType) {
    return {
        field: UpdateConversationFieldName.ParticipantsChange,
        userId: agentId,
        role: participantRole,
        type: participantChangeType
    };
}

module.exports = {
    v2: participantsChange.bind(v2Context),
    v3: participantsChange.bind(v3Context),
    participantsChangeData
};
