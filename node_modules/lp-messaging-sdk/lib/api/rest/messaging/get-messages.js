const {send} = require('../restRequestHelper');
const HttpMethod = require('../http-method');

async function getMessages({
    accountId,
    token,
    dialogId,
    maxQuantity = null,
    sequenceMin = null,
    sequenceMax = null,
    offset = null,
    filters = null
}) {

    // build the query parameters
    const queryParameters = [];

    if (maxQuantity !== null) {
        queryParameters.push(`limit=${maxQuantity}`);
    }

    if (sequenceMin !== null) {
        queryParameters.push(`newerThanSequence=${sequenceMin}`);
    }

    if (sequenceMax !== null) {
        queryParameters.push(`olderThanSequence=${sequenceMax}`);
    }

    if (offset !== null) {
        queryParameters.push(`offset=${offset}`);
    }

    if (filters !== null) {
        queryParameters.push(`filters=${filters}`);
    }

    const queryParameter = queryParameters.length > 0 ? '?' + queryParameters.join('&') : '';

    const path = `/v1/conversations/${dialogId}/dialogs/${dialogId}/messages${queryParameter}`;

    return await send({accountId, token, path, method: HttpMethod.GET});
}

module.exports = getMessages;
