const {send} = require('../restRequestHelper');
const MessageAudience = require('../../message-audience');
const RestMessageType = require('./rest-message-type');
const HttpMethod = require('../http-method');

async function publishMessage({
    accountId,
    token,
    conversationId,
    dialogId,
    text,
    metadata,
    messageAudience = MessageAudience.ALL
}) {

    const path = `/v1/conversations/${conversationId}/dialogs/${dialogId}/messages`;

    const data = {
        type: RestMessageType.PLAIN_TEXT,
        content: {
            text
        },
        metadata,
        messageAudience
    };

    return await send({accountId, token, path, data, method: HttpMethod.POST});
}

module.exports = publishMessage;
